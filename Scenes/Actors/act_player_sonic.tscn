[gd_scene load_steps=45 format=3 uid="uid://cyjbdi347hyhd"]

[ext_resource type="Script" path="res://Actors/Players/Sonic.cs" id="1_splnw"]
[ext_resource type="AudioStream" uid="uid://c7smi58wkyhhm" path="res://Assets/Audio/Sounds/Metal/snd_jump.wav" id="3_hh371"]
[ext_resource type="AudioStream" uid="uid://bsbgp1csl4cos" path="res://Assets/Audio/Sounds/Metal/snd_spindash_hold.wav" id="3_xb38u"]
[ext_resource type="AudioStream" uid="uid://chgjsejm2jvhc" path="res://Assets/Audio/Sounds/Metal/snd_spindash_release.wav" id="4_nw1sy"]
[ext_resource type="PackedScene" uid="uid://dkcu7fsvcyis3" path="res://Assets/Visual/Models/mdl_metalSonic.blend" id="6_n7joc"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vvscq"]
animation = &"Fall"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_g2j1y"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_6wb1p"]
animation = &"Jet"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5hih0"]
animation = &"Run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_r2tw5"]
animation = &"RunToSprint"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_iw10b"]
animation = &"Sprint"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_q2orv"]
animation = &"Walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7pyfv"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ag6lx"]
xfade_time = 1.0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_mhcp0"]
xfade_time = 0.5

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hui6l"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_vqjti"]
xfade_time = 0.5

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6yjx4"]
xfade_time = 0.5

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_k5wnt"]
xfade_time = 1.0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_1611m"]
xfade_time = 0.5

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6yr1w"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2wqx6"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_uwj6r"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_17dd5"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2obhp"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_62q48"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_y4uau"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xjweo"]
switch_mode = 1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8gv1w"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_yyt8d"]
states/End/position = Vector2(1119, 108)
states/Fall/node = SubResource("AnimationNodeAnimation_vvscq")
states/Fall/position = Vector2(666, 216)
states/Idle/node = SubResource("AnimationNodeAnimation_g2j1y")
states/Idle/position = Vector2(345, 100)
states/Jet/node = SubResource("AnimationNodeAnimation_6wb1p")
states/Jet/position = Vector2(862, 100)
states/Run/node = SubResource("AnimationNodeAnimation_5hih0")
states/Run/position = Vector2(602, 100)
states/RunToSprint/node = SubResource("AnimationNodeAnimation_r2tw5")
states/RunToSprint/position = Vector2(651, 28.9057)
states/Sprint/node = SubResource("AnimationNodeAnimation_iw10b")
states/Sprint/position = Vector2(737, 100)
states/Walk/node = SubResource("AnimationNodeAnimation_q2orv")
states/Walk/position = Vector2(478, 100)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_7pyfv"), "Idle", "Walk", SubResource("AnimationNodeStateMachineTransition_ag6lx"), "Walk", "Run", SubResource("AnimationNodeStateMachineTransition_mhcp0"), "Sprint", "Jet", SubResource("AnimationNodeStateMachineTransition_hui6l"), "Sprint", "Run", SubResource("AnimationNodeStateMachineTransition_vqjti"), "Run", "Walk", SubResource("AnimationNodeStateMachineTransition_6yjx4"), "Walk", "Idle", SubResource("AnimationNodeStateMachineTransition_k5wnt"), "Jet", "Sprint", SubResource("AnimationNodeStateMachineTransition_1611m"), "Idle", "Fall", SubResource("AnimationNodeStateMachineTransition_6yr1w"), "Fall", "Walk", SubResource("AnimationNodeStateMachineTransition_2wqx6"), "Fall", "Run", SubResource("AnimationNodeStateMachineTransition_uwj6r"), "Walk", "Fall", SubResource("AnimationNodeStateMachineTransition_17dd5"), "Run", "Fall", SubResource("AnimationNodeStateMachineTransition_2obhp"), "Sprint", "Fall", SubResource("AnimationNodeStateMachineTransition_62q48"), "Jet", "Fall", SubResource("AnimationNodeStateMachineTransition_y4uau"), "Run", "RunToSprint", SubResource("AnimationNodeStateMachineTransition_xjweo"), "RunToSprint", "Sprint", SubResource("AnimationNodeStateMachineTransition_8gv1w")]
graph_offset = Vector2(-28.4667, -7.09426)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_wa5yb"]
radius = 0.3

[sub_resource type="SphereShape3D" id="SphereShape3D_8e37d"]
radius = 0.58

[sub_resource type="SphereShape3D" id="SphereShape3D_qkshk"]
radius = 0.8

[sub_resource type="CylinderShape3D" id="CylinderShape3D_n7ipb"]
height = 0.1
radius = 0.3

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_3l85c"]
specular_mode = 1
albedo_color = Color(0.241793, 5.10186e-05, 0.8817, 1)
metallic = 1.0
metallic_specular = 0.68
roughness = 0.27

[sub_resource type="SphereMesh" id="SphereMesh_qhobh"]
material = SubResource("StandardMaterial3D_3l85c")
radius = 0.6
height = 1.2
radial_segments = 12
rings = 8

[sub_resource type="Animation" id="Animation_1hce8"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("..:scale")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.682784, 1.09072, 0.698563)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("..:position")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, -0.161624, -0.247377)]
}

[sub_resource type="Animation" id="Animation_q8sbu"]
resource_name = "speen"
length = 0.35
loop_mode = 1
step = 0.05
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(-6.28319, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, -0.3, 0), Vector3(0, -0.3, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("..:rotation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, 0, 0)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("..:scale")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(1, 1, 1), Vector3(1, 1, 1)]
}

[sub_resource type="Animation" id="Animation_fpqil"]
resource_name = "speendash"
length = 0.35
loop_mode = 1
step = 0.05
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(-6.28319, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0.790791, 0, 0), Vector3(0.790791, 0, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("..:scale")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0.8, 1.2, 0.8), Vector3(0.8, 1.2, 0.8)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("..:position")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.35),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, -0.161624, -0.247377), Vector3(0, -0.161624, -0.247377)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_yjqa6"]
_data = {
"RESET": SubResource("Animation_1hce8"),
"speen": SubResource("Animation_q8sbu"),
"speendash": SubResource("Animation_fpqil")
}

[sub_resource type="CylinderShape3D" id="CylinderShape3D_ytp2g"]
height = 16.0
radius = 10.0

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_4pwk4"]
emission_shape_offset = Vector3(0, 10, 0)
emission_shape = 3
emission_box_extents = Vector3(20, 0, 20)
direction = Vector3(-0.5, -1, -0.2)
spread = 0.0
initial_velocity_min = 40.22
initial_velocity_max = 40.22
gravity = Vector3(0, 0, 0)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_nunea"]
shading_mode = 0
albedo_color = Color(0.31386, 0.370009, 0.592725, 1)
billboard_keep_scale = true

[sub_resource type="QuadMesh" id="QuadMesh_gayre"]
material = SubResource("StandardMaterial3D_nunea")
size = Vector2(0.05, 0.15)

[node name="Sonic" type="CharacterBody3D"]
collision_layer = 2
floor_snap_length = 1.0
script = ExtResource("1_splnw")
animatorPath = NodePath("mdl_metalSonic/AnimationPlayer")
standingColliderPath = NodePath("StandingShape")
ballColliderPath = NodePath("BallShape")
standingModelPath = NodePath("mdl_metalSonic")
ballModelPath = NodePath("Ball")
floorCastPath = NodePath("FloorCast2")
homingAttackAreaPath = NodePath("HomingAttackArea")
spinHoldSoundPath = NodePath("SpinChargeSound")
spinReleaseSoundPath = NodePath("SpinReleaseSound")
jumpSoundPath = NodePath("JumpSound")
startingSpeed = 4.0
joggingSpeed = 15.0
runningSpeed = 25.0
sprintingSpeed = 35.0
maximumSpeed = 75.0
acceleration = 12.0
deceleration = 30.0
airAcceleration = 12.0
airDeceleration = 15.0
turnSpeed = 20.0
turnFriction = 1.0
jumpableStates = [0, 1, 4]
maxJumpHeight = 6.0
bounceVelocity = 22.0
minimumDashSpeed = 15.0
maximumDashSpeed = 55.0
homingAttackableStates = [2, 1, 5, 8]
homingAttackRechargeStates = [0, 3, 4, 8]
homingAttackSpeed = 35.0
homingAttackAccuracy = 22.0
animations = {
"HomingAttackBounce": "HomingAttackBounce",
"Idle": "Idle",
"Jet": "Jet",
"Jog": "Walk",
"Run": "Run",
"SpringJump": "Jump",
"Sprint": "Sprint",
"StandFall": "Fall"
}

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../mdl_metalSonic")
tree_root = SubResource("AnimationNodeStateMachine_yyt8d")
anim_player = NodePath("../mdl_metalSonic/AnimationPlayer")

[node name="StandingShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.2, 0)
shape = SubResource("CapsuleShape3D_wa5yb")

[node name="BallShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.49012e-08, 0)
shape = SubResource("SphereShape3D_8e37d")
disabled = true

[node name="JumpHurtBox" type="Area3D" parent="BallShape"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.49012e-08, 0)
collision_layer = 0
collision_mask = 8

[node name="CollisionShape3D" type="CollisionShape3D" parent="BallShape/JumpHurtBox"]
shape = SubResource("SphereShape3D_qkshk")

[node name="FloorCast2" type="ShapeCast3D" parent="."]
shape = SubResource("CylinderShape3D_n7ipb")
target_position = Vector3(0, -1.2, 0)

[node name="mdl_metalSonic" parent="." instance=ExtResource("6_n7joc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.8, 0)

[node name="Skeleton3D" parent="mdl_metalSonic/Armature" index="0"]
bones/0/position = Vector3(0, 0.429349, 0)
bones/0/rotation = Quaternion(0, 0.707107, 0.707107, 0)
bones/1/position = Vector3(1.01041e-07, -0.565305, 5.15365)
bones/1/rotation = Quaternion(2.52221e-08, 0.9997, -0.0245072, -1.02886e-06)
bones/1/scale = Vector3(1, 1, 1)
bones/2/position = Vector3(1.18334e-06, -1.61807, -0.590835)
bones/2/rotation = Quaternion(0.493428, 0.138202, 0.855025, 0.0797555)
bones/2/scale = Vector3(0, 0, 0)
bones/3/position = Vector3(0.755479, 4.3533, 3.56073)
bones/3/rotation = Quaternion(0.689565, -0.000423187, -0.000401499, 0.724223)
bones/3/scale = Vector3(1, 1, 1)
bones/4/position = Vector3(0.64063, 3.30639, 0.856272)
bones/4/rotation = Quaternion(-0.0245072, -0.00058419, 1.4202e-05, 0.999699)
bones/4/scale = Vector3(1, 1, 1)
bones/5/position = Vector3(1.37878, -2.17074, -0.740566)
bones/5/rotation = Quaternion(0.487597, -0.512104, -0.487596, 0.512103)
bones/5/scale = Vector3(1, 1, 1)
bones/6/position = Vector3(0.972518, -1.53152, -2.2787)
bones/6/rotation = Quaternion(-0.724223, -6.88677e-07, -7.25352e-07, 0.689565)
bones/7/position = Vector3(-0.75549, -3.35984, 2.26361)
bones/7/rotation = Quaternion(0.689565, 0.000421679, 0.000402936, 0.724223)
bones/7/scale = Vector3(1, 1, 1)
bones/8/position = Vector3(-0.640635, 1.7897, 1.90716)
bones/8/rotation = Quaternion(1.42336e-05, 0.999699, -0.0245072, -0.000582238)
bones/8/scale = Vector3(1, 1, 1)
bones/9/position = Vector3(-1.25998, 3.53856, -1.01893)
bones/9/rotation = Quaternion(0.487596, 0.512103, 0.487597, 0.512104)
bones/10/position = Vector3(-2.45766, 2.65438, -0.772399)
bones/10/rotation = Quaternion(-0.724223, -6.88677e-07, -7.25352e-07, 0.689565)
bones/11/rotation = Quaternion(-0.6595, 0.0924751, -0.112871, 0.737406)
bones/11/scale = Vector3(1, 1, 1)
bones/12/rotation = Quaternion(-0.0735236, -0.0813085, 0.00697935, 0.993949)
bones/12/scale = Vector3(1, 1, 1)
bones/13/rotation = Quaternion(0.0407164, 0.630371, -0.741613, 0.225799)
bones/13/scale = Vector3(1, 1, 1)
bones/14/rotation = Quaternion(0.21113, 0.103216, -0.00527274, 0.971979)
bones/14/scale = Vector3(1, 1, 1)
bones/15/rotation = Quaternion(0.0898118, 0.454556, -0.124763, 0.877352)
bones/15/scale = Vector3(1, 1, 1)
bones/16/rotation = Quaternion(0.175924, 0.330239, 0.729965, 0.571966)
bones/16/scale = Vector3(1, 1, 1)
bones/17/rotation = Quaternion(0.335659, -0.0994619, 0.00838333, 0.93668)
bones/17/scale = Vector3(1, 1, 1)
bones/18/rotation = Quaternion(0.0335116, -0.0811659, -0.00560515, 0.996121)
bones/19/rotation = Quaternion(0.344945, 0.0155151, -0.0122979, 0.938414)
bones/19/scale = Vector3(1, 1, 1)
bones/20/rotation = Quaternion(0.00480139, 0.00204574, -0.000249116, 0.999986)
bones/20/scale = Vector3(1, 1, 1)
bones/21/rotation = Quaternion(-0.670824, -0.362028, 0.354196, 0.541735)
bones/21/scale = Vector3(1, 1, 1)
bones/22/rotation = Quaternion(0.841962, -0.00472686, 0.0117328, 0.539388)
bones/22/scale = Vector3(1, 1, 1)
bones/23/rotation = Quaternion(0.439387, -0.00183712, 0.022797, 0.898007)
bones/23/scale = Vector3(1, 1, 1)
bones/24/rotation = Quaternion(-0.466236, 0.44472, -0.229218, 0.729594)
bones/24/scale = Vector3(1, 1, 1)

[node name="AnimationPlayer" parent="mdl_metalSonic" index="1"]
autoplay = "Idle"

[node name="Ball" type="Node3D" parent="."]
visible = false

[node name="Ball" type="Node3D" parent="Ball"]
transform = Transform3D(0.682784, 0, 0, 0, 1.09072, 0, 0, 0, 0.698563, 0, -0.161624, -0.247377)

[node name="Ball" type="MeshInstance3D" parent="Ball/Ball"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.3, 0)
mesh = SubResource("SphereMesh_qhobh")
skeleton = NodePath("../../..")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Ball/Ball/Ball"]
libraries = {
"": SubResource("AnimationLibrary_yjqa6")
}
autoplay = "speen"

[node name="JumpSound" type="AudioStreamPlayer" parent="."]
stream = ExtResource("3_hh371")

[node name="SpinChargeSound" type="AudioStreamPlayer" parent="."]
stream = ExtResource("3_xb38u")

[node name="SpinReleaseSound" type="AudioStreamPlayer" parent="."]
stream = ExtResource("4_nw1sy")

[node name="HomingAttackArea" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="HomingAttackArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -6.5, 0)
shape = SubResource("CylinderShape3D_ytp2g")

[node name="GPUParticles3D" type="GPUParticles3D" parent="."]
amount = 1000
lifetime = 2.0
visibility_aabb = AABB(-10, -10, -10, 20, 20, 20)
transform_align = 3
process_material = SubResource("ParticleProcessMaterial_4pwk4")
draw_pass_1 = SubResource("QuadMesh_gayre")

[connection signal="body_entered" from="BallShape/JumpHurtBox" to="." method="OnBallHurtBoxEntered"]

[editable path="mdl_metalSonic"]
